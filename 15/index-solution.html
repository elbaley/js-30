<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>LocalStorage</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="https://fav.farm/ðŸ”¥" />
</head>

<body>

  <div class="wrapper">
    <h2>SHOPPING LIST</h2>
    <p></p>
    <ul class="products">
      <li>Loading shopping list...</li>
    </ul>
    <form class="add-items">
      <button type="button" id="clear">Clear</button>
      <input type="text" name="item" placeholder="Item Name" required>
      <input type="submit" value="+ Add Item">
    </form>
  </div>

  <script>
    const addItems = document.querySelector('.add-items');
    const itemsList = document.querySelector('.products');
    // localStorage'dan items adlÄ± deÄŸiÅŸkeni al, yoksa boÅŸ bir array oluÅŸtur
    const items = JSON.parse(localStorage.getItem('items')) || [];
    const clearButton = document.querySelector('#clear');

    function addItem(e) {
      // varsayÄ±lan olarak form gÃ¶nderildiginde sayfa yenilenecektir bunu engelleyelim
      e.preventDefault();
      // inputa eklenen yeni elemanin deÄŸerini inputu seÃ§ip .value deÄŸerine bakarak alÄ±yoruz
      const text = (this.querySelector('[name=item]')).value;
      // yeni alÄ±nacak Ã¼rÃ¼n iÃ§in bir obje oluÅŸturuyoruz 
      const item = {
        text: text,
        done: false
      }

      // oluÅŸturduÄŸumuz objeyi Ã¼rÃ¼nleri sakladÄ±ÄŸÄ±mÄ±z array'e ekliyoruz.
      items.push(item);
      //GÃ¼ncellenmiÅŸ listeyi gÃ¶stermek iÃ§in populateList fonksiyonunu Ã§aÄŸÄ±rÄ±yoruz
      populateList(items, itemsList);
      // GÃ¼ncellenmiÅŸ items dizisini localStorage'a kaydediyoruz
      localStorage.setItem('items', JSON.stringify(items));
      // formu sÄ±fÄ±rlayalÄ±m 
      this.reset();
    }

    function toggleDone(e) {
      //TÄ±klanan element input deÄŸilse fonksiyondan Ã§Ä±kÄ±yoruz
      if (!e.target.matches('input')) return;
      const el = e.target;
      // TÄ±klanan Ã¶ÄŸenin 'data-index' Ã¶zelliÄŸinden hangi Ã¶ÄŸe olduÄŸunu belirliyoruz
      const index = el.dataset.index
      // SeÃ§ilen Ã¶ÄŸenin 'done' Ã¶zelliÄŸini tersine Ã§eviriyoruz
      items[index].done = !items[index].done;
      // GÃ¼ncellenmiÅŸ items dizisini localStorage'a kaydediyoruz
      localStorage.setItem('items', JSON.stringify(items));
      // GÃ¼ncellenmiÅŸ listeyi gÃ¶stermek iÃ§in populateList fonksiyonunu Ã§aÄŸÄ±rÄ±yoruz
      populateList(items, itemsList);
      
    }

    function clearAll(){
      //localStorage'daki tÃ¼m verileri siliyoruz
      localStorage.setItem('items',JSON.stringify([]))
      // sildikten sonra tekrar fonksiyonumuz ile gÃ¶rÃ¼nen listeyi gÃ¼ncelliyoruz
      populateList([],itemsList);
    }

    // populateList fonksiyonu bir liste ve hedef element alÄ±yor.
    // listedeki her bir obje iÃ§in li ve input elementlerinden oluÅŸan bir HTML hazÄ±rlÄ±yor 
    // son olarak hedef elementinin iÃ§indeki HTMLi gÃ¼ncelliyor
    // bÃ¶ylece her bir Ã¼rÃ¼n iÃ§in sayfada li elementi oluÅŸturuluyor
    function populateList(list = [], element) {
      element.innerHTML = list.map((item, i) => {
        return `
        <li>
          <input type="checkbox" data-index=${i} id="item${i}" ${item.done ? 'checked' : ''}>
          <label for="item${i}">${item.text}</label>
        </li>
        `
      }).join('');
    }



    addItems.addEventListener('submit', addItem)
    itemsList.addEventListener('click', toggleDone)
    clearButton.addEventListener('click',clearAll) 
    // sayfa yÃ¼klendiÄŸinde Ã¶ÄŸeleri listele
    populateList(items, itemsList);
  </script>
</body>
</html>
